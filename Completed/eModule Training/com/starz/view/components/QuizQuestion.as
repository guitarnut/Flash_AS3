package com.starz.view.components{	import flash.display.MovieClip;	import flash.events.MouseEvent;	import com.starz.events.TrainingEvent;	import com.greensock.TweenLite;	import flash.media.Sound;	import com.starz.view.screens.base.TrainingScreen;	import com.starz.constants.TrainingData;	import com.starz.audio.AudioManager;	import flash.events.Event;	public class QuizQuestion extends MovieClip	{		private static const TWEEN_SPEED:Number = .25;		private var _correctAnswers:Number = 0;		private var _correctTotal:Number = 0;		private var _answers:Array;		private var _audio:AudioManager;		private var _mp3_question:Sound;		private var _mp3_correct:Sound;		private var _mp3_incorrect:Sound;		private var _text:SimpleMC;		private var _correct:SimpleMC;		private var _incorrect:SimpleMC;		private var _stamp:String;		public function QuizQuestion()		{			init();		}		private function init():void		{			_answers = new Array();			_audio = new AudioManager();			b_next.visible = false;			b_next.addEventListener(MouseEvent.CLICK, hideQuestion);			_text = SimpleMC(getChildAt(numChildren - 1));			_correct = SimpleMC(getChildAt(numChildren - 2));			_incorrect = SimpleMC(getChildAt(numChildren - 3));			reset();		}		public function startQuiz(c$:Array, i$:Array = null, s1$:* = null, s2$:* = null, s3$:* = null):void		{			_mp3_question = s1$;			_mp3_correct = s2$;			_mp3_incorrect = s3$;			correctAnswers(c$);			if (i$)			{				incorrectAnswers(i$);			}			showQuestion();		}		private function correctAnswers(c$:Array):void		{			for each (var answer:TButton in c$)			{				_correctTotal++;				if (! answer.hasEventListener(MouseEvent.CLICK))				{					_answers.push(answer);					answer.addEventListener(MouseEvent.CLICK, correctAnswer);				}			}		}		private function incorrectAnswers(i$:Array):void		{			for each (var answer:TButton in i$)			{				if (! answer.hasEventListener(MouseEvent.CLICK))				{					_answers.push(answer);					answer.addEventListener(MouseEvent.CLICK, incorrectAnswer);				}			}		}		private function showQuestion():void		{			new TweenLite(this,TWEEN_SPEED,{alpha:1});			_text.showMC();			_audio.addEventListener(Event.COMPLETE, showAnswers);			_audio.playAudio(_mp3_question);		}		private function correctAnswer(e:MouseEvent):void		{			if (TButton(e.target).active)			{				_correctAnswers++;				TButton(e.target).toggleButton(false);				toggleHint(true);				if (_correctAnswers == _correctTotal)				{					questionPassed();				}			}		}		private function incorrectAnswer(e:MouseEvent):void		{			if (TButton(e.target).active)			{				questionFailed();			}		}		private function questionPassed():void		{			toggleHint(false);			disableAnswers();			hideAnswers();			_correct.showMC(.5);			dispatchEvent(new TrainingEvent(TrainingEvent.QUESTION_PASSED, true, true));			_audio.addEventListener(Event.COMPLETE, questionComplete);			_audio.playAudio(_mp3_correct);			addStamp();		}		private function questionFailed():void		{			toggleHint(false);						disableAnswers();			hideAnswers();			_incorrect.showMC(.5);			dispatchEvent(new TrainingEvent(TrainingEvent.QUESTION_FAILED, true, true));			_audio.addEventListener(Event.COMPLETE, questionComplete);			_audio.playAudio(_mp3_incorrect);		}		private function questionComplete(e:Event):void		{			_audio.removeEventListener(Event.COMPLETE, questionComplete);			b_next.visible = true;			b_next.showButton();		}		private function showAnswers(e:Event):void		{			_audio.removeEventListener(Event.COMPLETE, showAnswers);			enableAnswers();						var $d:Number=0;			for each (var answer:TButton in _answers)			{				answer.showButton($d);				$d+=.2;			}		}		private function hideAnswers():void		{			for each (var answer:TButton in _answers)			{				answer.hideButton();			}		}		private function toggleHint(b$:Boolean):void		{			try			{				if (b$)				{					hint.showMC();				}				else				{					hint.hideMC();										//There's a bug in one of the FLAs that's keeping it from fading out.  This is a quick fix...					hint.x = -1000;				}			}			catch (e:Error)			{				trace('Error: '+e);			}		}		private function enableAnswers():void		{			for each (var answer:TButton in _answers)			{				answer.toggleButton(true);			}		}		private function disableAnswers():void		{			for each (var answer:TButton in _answers)			{				answer.toggleButton(false);			}		}		private function addStamp():void		{		}		public function hideQuestion(e:MouseEvent):void		{			new TweenLite(this,TWEEN_SPEED,{alpha:0,onComplete:nextQuestion});		}		private function nextQuestion():void		{			TrainingScreen(this.parent).advanceScreen();			reset();		}		private function reset():void		{		}		public function set stamp(s$):void		{			_stamp = s$;		}	}}