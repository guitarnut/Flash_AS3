package com.starz.view.screens{	import com.greensock.TweenLite;	import com.starz.events.TrainingEvent;	import com.starz.view.components.FLVBackground;	import com.starz.view.components.TButton;	import com.starz.constants.Status;	import flash.events.MouseEvent;	import com.starz.view.components.SimpleMC;	import flash.utils.Timer;	import flash.events.TimerEvent;	import com.starz.constants.TrainingData;	public class SelectLocation extends TrainingScreen	{		private static const TIMER_SPEED:Number = 1000;		private var TIMER_TOTAL:Number = 10;		private var _buttons:Array;		private var _chosenScreen:String;		private var _timer:Timer;		private var _locationsVisited:Number;		public function SelectLocation()		{			init();		}		private function init():void		{			_locationsVisited = 0;			_timer = new Timer(TIMER_SPEED,0);			_timer.addEventListener(TimerEvent.TIMER, handleTimer);						visited1.visible=false;			visited2.visible=false;			visited3.visible=false;			visited4.visible=false;			timeText.text = "00:" + String(TIMER_TOTAL);		}		private function setButtons():void		{			var locations:Array = getTrainingData(TrainingData.SECTIONS_COMPLETED);			_buttons = new Array();			_buttons.push(location1, location2, location3, location4);			for each (var locName:String in locations)			{				switch (locName)				{					case "location 1" :						TButton(location1).toggleButton(false);						visited1.visible=true;						SimpleMC(visited1).showMC();						_locationsVisited++;						break;					case "location 2" :						TButton(location2).toggleButton(false);						visited2.visible=true;						SimpleMC(visited2).showMC();						_locationsVisited++;						break;					case "location 3" :						TButton(location3).toggleButton(false);						visited3.visible=true;						SimpleMC(visited3).showMC();						_locationsVisited++;						break;					case "location 4" :						TButton(location4).toggleButton(false);						visited4.visible=true;						SimpleMC(visited4).showMC();						_locationsVisited++;						break;				}			}		}		override protected function animate():void		{			FLVBackground(getChildAt(0)).playBG();			playMusic(new soundtrack);			setButtons();			showButtons();			addListeners();			likeLoveMessage();			_timer.start();		}		private function likeLoveMessage():void		{			switch (_locationsVisited)			{				case 0 :					playAudio(new audio1, false);					text_message1.showMC();					break;				case 1 :					playAudio(new audio2, false);					text_message2.showMC();					break;				case 2 :					playAudio(new audio3, false);					text_message3.showMC();					break;				case 3 :					playAudio(new audio4, false);					text_message4.showMC();					break;			}		}		private function handleTimer(e:TimerEvent):void		{			TIMER_TOTAL--;			timeText.text = "00:0" + String(TIMER_TOTAL);			if (TIMER_TOTAL == 0)			{				_timer.stop();				_timer.removeEventListener(TimerEvent.TIMER, handleTimer);				timesUp();			}			if (TIMER_TOTAL == 3)			{				hurry.showMC();			}		}		private function timesUp():void		{			removeListeners();			if (location1.active)			{				_chosenScreen = TrainingEvent.GOTO_LOCATION_ONE;				setTrainingData(TrainingData.SECTIONS_COMPLETED, "location 1");			}			else if (location2.active)			{				_chosenScreen = TrainingEvent.GOTO_LOCATION_TWO;				setTrainingData(TrainingData.SECTIONS_COMPLETED, "location 2");			}			else if (location3.active)			{				_chosenScreen = TrainingEvent.GOTO_STARZ_STUDIOS;				setTrainingData(TrainingData.SECTIONS_COMPLETED, "location 3");			}			else if (location4.active)			{				_chosenScreen = TrainingEvent.GOTO_SALES;				setTrainingData(TrainingData.SECTIONS_COMPLETED, "location 4");			}			advanceScreen();		}		private function addListeners():void		{			for each (var button:TButton in _buttons)			{				if (TButton(button).active)				{					button.addEventListener(MouseEvent.CLICK, handleClick);					button.toggleButton(true);				}			}		}		private function removeListeners():void		{			for each (var button:TButton in _buttons)			{				if (TButton(button).active)				{					button.removeEventListener(MouseEvent.CLICK, handleClick);				}			}		}		private function handleClick(e:MouseEvent):void		{			_timer.stop();			_timer.removeEventListener(TimerEvent.TIMER, handleTimer);			switch (e.target.name)			{				case "location1" :					_chosenScreen = TrainingEvent.GOTO_LOCATION_ONE;					setTrainingData(TrainingData.SECTIONS_COMPLETED, "location 1");					break;				case "location2" :					_chosenScreen = TrainingEvent.GOTO_LOCATION_TWO;					setTrainingData(TrainingData.SECTIONS_COMPLETED, "location 2");					break;				case "location3" :					_chosenScreen = TrainingEvent.GOTO_STARZ_STUDIOS;					setTrainingData(TrainingData.SECTIONS_COMPLETED, "location 3");					break;				case "location4" :					_chosenScreen = TrainingEvent.GOTO_SALES;					setTrainingData(TrainingData.SECTIONS_COMPLETED, "location 4");					break;				default :					break;			}			advanceScreen();		}		private function showButtons():void		{			for each (var button:TButton in _buttons)			{				button.showButton(.25);			}		}		override protected function reset():void		{			switch (_chosenScreen)			{				case TrainingEvent.GOTO_LOCATION_ONE :					fireEvent(TrainingEvent.GOTO_LOCATION_ONE);					break;				case TrainingEvent.GOTO_LOCATION_TWO :					fireEvent(TrainingEvent.GOTO_LOCATION_TWO);					break;				case TrainingEvent.GOTO_STARZ_STUDIOS :					fireEvent(TrainingEvent.GOTO_STARZ_STUDIOS);					break;				case TrainingEvent.GOTO_SALES :					fireEvent(TrainingEvent.GOTO_SALES);					break;				default :					break;			}			fireEvent(TrainingEvent.SECTION_COMPLETE);		}	}}