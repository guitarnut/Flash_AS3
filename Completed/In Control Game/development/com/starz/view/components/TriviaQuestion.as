package com.starz.view.components{	import flash.display.MovieClip;	import com.starz.events.GameEvent;	import flash.events.MouseEvent;	import com.greensock.TweenLite;	import com.starz.constants.ApplicationSettings;	public class TriviaQuestion extends MovieClip	{		private var _targetX:Number;		private var _tween:TweenLite;		private var _wrongAnswer:Boolean = false;		public function TriviaQuestion():void		{			init();		}		private function init():void		{			continueButton.visible = false;			continueButton.addEventListener(MouseEvent.CLICK, questionComplete);			_targetX = x;			x = ApplicationSettings.STAGE_WIDTH;			addListeners();		}		private function addListeners():void		{			triviaTimer.addEventListener(GameEvent.TIMES_UP, timesUp);			correctAnswer.addEventListener(MouseEvent.CLICK, checkAnswer);			incorrect_1.addEventListener(MouseEvent.CLICK, checkAnswer);			if (incorrect_2)			{				incorrect_2.addEventListener(MouseEvent.CLICK, checkAnswer);			}			if (incorrect_3)			{				incorrect_3.addEventListener(MouseEvent.CLICK, checkAnswer);			}		}		private function removeListeners():void		{			triviaTimer.removeEventListener(GameEvent.TIMES_UP, timesUp);			if (correctAnswer.hasEventListener(MouseEvent.CLICK))			{				correctAnswer.removeEventListener(MouseEvent.CLICK, checkAnswer);			}			if (incorrect_1.hasEventListener(MouseEvent.CLICK))			{				incorrect_1.removeEventListener(MouseEvent.CLICK, checkAnswer);			}			if (incorrect_2)			{				if (incorrect_2.hasEventListener(MouseEvent.CLICK))				{					incorrect_2.removeEventListener(MouseEvent.CLICK, checkAnswer);				}			}			if (incorrect_3)			{				if (incorrect_3.hasEventListener(MouseEvent.CLICK))				{					incorrect_3.removeEventListener(MouseEvent.CLICK, checkAnswer);				}			}		}		public function startTrivia():void		{			triviaTimer.startTimer(2);		}		private function checkAnswer(e:MouseEvent):void		{			if (e.target.name == 'correctAnswer')			{				rightAnswer();				correctFeedback.visible = true;			}			else			{				wrongAnswer();				incorrectFeedback.visible = true;				//e.target.removeEventListener(MouseEvent.CLICK, checkAnswer);				e.target.alpha = .2;				rightAnswer();			}		}		private function rightAnswer():void		{			removeListeners();			revealRightAnswer();			triviaTimer.pauseTimer();			var gameData:Object = new Object();			if (! _wrongAnswer)			{				gameData.timeRemaining = triviaTimer.timeRemaining;				timeBonus.text = gameData.timeRemaining + " bonus points.";			}			else			{				gameData.timeRemaining = 0;				timeBonus.text = "No bonus points awarded.";			}			dispatchEvent(new GameEvent(GameEvent.CORRECT_ANSWER, gameData));			continueButton.visible = true;		}		private function wrongAnswer():void		{			_wrongAnswer = true;			timeBonus.text = "That is not correct!";			dispatchEvent(new GameEvent(GameEvent.INCORRECT_ANSWER));		}		private function timesUp(e:GameEvent):void		{			_wrongAnswer = true;			dispatchEvent(new GameEvent(GameEvent.TIMES_UP));		}		private function revealRightAnswer():void		{			incorrect_1.alpha = .2;			if (incorrect_2)			{				incorrect_2.alpha = .2;			}			if (incorrect_3)			{				incorrect_3.alpha = .2;			}		}		private function questionComplete(e:MouseEvent):void {			dispatchEvent(new GameEvent(GameEvent.NEXT_QUESTION));		}		private function resetText():void {			timeBonus.text = "";		}		public function showMe():void		{			resetText();			_tween = new TweenLite(this,.75,{x:_targetX,onComplete:startTrivia});		}		public function hideMe():void		{			resetText();			_tween = new TweenLite(this,.75,{x:ApplicationSettings.STAGE_WIDTH});		}		public function reset():void {			x = ApplicationSettings.STAGE_WIDTH;			continueButton.visible = false;			triviaTimer.reset();			addListeners();			correctFeedback.visible = false;			incorrectFeedback.visible = false;			incorrect_1.alpha = 0;			if (incorrect_2)			{				incorrect_2.alpha = 0;			}			if (incorrect_3)			{				incorrect_3.alpha = 0;			}		}	}}